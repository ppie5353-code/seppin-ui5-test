<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>UI5 Proxy Test</title>
    <script id="sap-ui-bootstrap"
        src="https://ui5.sap.com/resources/sap-ui-core.js"
        data-sap-ui-theme="sap_horizon"
        data-sap-ui-libs="sap.m"
        data-sap-ui-async="true">
    </script>

    <script>
        // 초기화 함수
        window.onload = function() {
            sap.ui.getCore().attachInit(function() {
                
                // 1. 입력 필드
                var oInput = new sap.m.Input({
                    placeholder: "https://your-proxy.com/api",
                    width: "100%"
                });

                // 2. 결과창
                var oResultText = new sap.m.TextArea({
                    width: "100%",
                    rows: 15,
                    editable: false,
                    placeholder: "결과가 여기에 표시됩니다."
                });

                // 3. 버튼
                var oButton = new sap.m.Button({
                    text: "프록시 호출 테스트",
                    type: "Emphasized",
                    width: "100%",
                    press: function() {
                        var sUrl = oInput.getValue();
                        if (!sUrl) {
                            sap.m.MessageToast.show("URL을 입력해주세요.");
                            return;
                        }

                        oResultText.setValue("호출 중...");

                        // jQuery를 이용한 AJAX 호출
                        $.ajax({
                            url: sUrl,
                            method: "GET",
                            success: function(data) {
                                oResultText.setValue(JSON.stringify(data, null, 2));
                                sap.m.MessageToast.show("성공!");
                            },
                            error: function(err) {
                                oResultText.setValue("에러 발생!\n상태 코드: " + err.status + "\n내용: " + err.statusText);
                                sap.m.MessageToast.show("실패!");
                            }
                        });
                    }
                });

                // 4. 레이아웃 배치 (VBox)
                var oVBox = new sap.m.VBox({
                    items: [
                        new sap.m.Label({ text: "프록시 주소 입력:", design: "Bold" }),
                        oInput, 
                        oButton, 
                        new sap.m.Label({ text: "응답 결과:", design: "Bold" }).addStyleClass("sapUiSmallMarginTop"),
                        oResultText
                    ]
                });
                
                // 마진 추가
                oVBox.addStyleClass("sapUiSmallMargin");

                // 5. 페이지 구성 및 렌더링
                new sap.m.Shell({
                    app: new sap.m.App({
                        pages: [
                            new sap.m.Page({
                                title: "UI5 Proxy Connection Test",
                                content: [oVBox]
                            })
                        ]
                    })
                }).placeAt("content");
            });
        };
    </script>
</head>
<body class="sapUiBody" id="content">
    </body>
</html>
